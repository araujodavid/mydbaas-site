<!DOCTYPE html>
<!--[if lt IE 7 ]><html class="ie ie6" lang="en"> <![endif]-->
<!--[if IE 7 ]><html class="ie ie7" lang="en"> <![endif]-->
<!--[if IE 8 ]><html class="ie ie8" lang="en"> <![endif]-->
<!--[if (gte IE 9)|!(IE)]><!-->
<html class="not-ie" lang="en">
<!--<![endif]-->
<head>
<meta charset="utf-8">
<meta name="description" content="business portfolio site template" />
<meta name="keywords" content="business, marketing, corporate, app, software, marketing"/>
<meta name="author" content="Tansh" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<title>MyDBaaS - API</title>

<!--Fav and touch icons-->
<link rel="shortcut icon" href="img/icons/favicon.ico">
<link rel="apple-touch-icon" href="img/icons/apple-touch-icon.png">
<link rel="apple-touch-icon" sizes="72x72" href="img/icons/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="114x114" href="img/icons/apple-touch-icon-114x114.png">

<!--google web font-->
<link href='http://fonts.googleapis.com/css?family=Raleway:400,600,700' rel='stylesheet' type='text/css'>

<!--style sheet-->
<link rel="stylesheet" media="screen" href="css/bootstrap.css"/>
<link rel="stylesheet" media="screen" href="css/bootstrap-responsive.css"/>
<link rel="stylesheet" media="screen" href="css/style.css"/>

<!--jquery libraries / others are at the bottom-->
<script type="text/javascript" src="js/jquery-1.7.1.min.js"></script>
<script src="js/modernizr.js" type="text/javascript"></script>

<!--prettify scripts starts-->
<script src="js/prettify.js" type="text/javascript"></script>
<link rel="stylesheet" media="screen" href="css/prettify.css"/>
<script>
// Activate Google Prettify in this page
addEventListener('load', prettyPrint, false);
$(document).ready(function(){
// Add prettyprint class to pre elements
$('pre').addClass('prettyprint');
}); // end document.ready
</script>
<!--prettify scripts ends-->

<!--contact form script starts-->
<script src="js/jquery.validate.js" type="text/javascript"></script>
<script src="js/jquery.form.js" type="text/javascript"></script>
<script type="text/javascript"> 
$(document).ready(function() {
        //Contact form
		$(function() {
		var v = $("#contactform").validate({
		submitHandler: function(form) {
		$(form).ajaxSubmit({
		target: "#result",
		clearForm: true
		});
		}
		});
		});
		//To clear message field on page refresh (you may clear other fields too, just give the 'id to input field' in html and mention it here, as below)
		$('#contactform #message').val('');
});
</script>
<!--contact form script ends-->

</head>
<body>

<!-- header starts
================================================== -->
<section id="header" class="clearfix">
  <div class="container">
    <div class="row"> 
      
      <!--logo starts-->
      <div class="span4 logo">
        <p style="height:25px; font-size:28px; padding-top:7px; text-shadow:0px 2px 0px #000;">
          <span style="float:left; color:#646464;"><b>My</b></span>
          <span style="float:left; color:#d95b44;"><b>DBaaS</b></span>
          <span style="float:left; color:#646464;"><b>API</b></span>
        </p>
      </div>
      <!--logo ends-->
      
      <div class="span8 clearfix"> 
        
        <!--menu starts-->
        <div id="smoothmenu" class="ddsmoothmenu">
          <ul>
            <li><a href="index.html">Screencast</a></li>
            <li><a href="publications.html">Publications</a></li>
            <li><a href="about.html">About</a> </li>
            <li><a href="framework.html">Framework</a> </li>
            <li><a href="api.html" class="selected">API</a> </li>
          </ul>
        </div>
        <!--menu ends--> 
        
      </div>
    </div>
  </div>
</section>
<!-- header ends
================================================== --> 

<!-- header-btm starts
================================================== -->
<section id="header-btm" class="clearfix">
  <div class="container">
    <div class="row">
      <div class="span12">
        <h4 class="heading-icon"> <img src="img/icons/heading-icon-support.png" width="40" height="40" alt="icon" class="icon-small-bg"> Features</h4>
      </div>
    </div>
  </div>
</section>
<!-- header-btm ends
================================================== --> 

<!-- content starts
================================================== -->
<section id="content" class="clearfix">
  <div class="container">
    <div class="row"> 
      
      <!--main content starts-->
      <div class="main-content span12">
        <h4>How-to</h4>
        <div class="accordion"> 
          
          <!--first group starts-->
          <div class="accordion-group">
            <div class="accordion-heading"> <a class="accordion-toggle" data-toggle="collapse" href="#collapseOne">- How to create the connection with the server?</a> </div>
            <div id="collapseOne" class="accordion-body collapse in">
              <div class="accordion-inner">
                <p>The first step to use the API is create the connection to the server. This connection is created from the class <b>MyDBaaSClient</b>, <a href="http://github.com/araujodavid/mydbaas-starting-project/blob/master/mydbaas-api/src/main/java/br/com/arida/ufc/mydbaas/api/client/MyDBaaSClient.java" target="_blank">details</a>.</p>
                <p>To connect create an instance of the class and pass the default url of the server.</p>
                <pre class="prettyprint linenums">
MyDBaaSClient client = new MyDBaaSClient("http://localhost:8080/mydbaas");</pre>
                <p>You can test if the connection is ok. The following method returns a boolean:</p>
                <pre class="prettyprint linenums">
boolean status = client.hasConnection();</pre>
              </div>
            </div>
          </div>
          <!--first group ends--> 
          
          <!--second group starts-->
          <div class="accordion-group">
            <div class="accordion-heading"> <a class="accordion-toggle" data-toggle="collapse" href="#collapseTwo">- How to query the resources registered in the knowledge base?</a> </div>
            <div id="collapseTwo" class="accordion-body collapse in">
              <div class="accordion-inner">
                <p>With the client object created just invoke the various methods for querying resources.</p>                
                <pre class="prettyprint linenums">
DBaaSPool dBaaSPool = client.getMyDBaaSs();

HostPool hostPool = client.getMyHosts();

VirtualMachinePool virtualMachinePool = client.getMyVirtualMachines();

DBMSPool dbmsPool = client.getMyDBMSs();

DatabasePool databasePool = client.getMyDatabases();</pre>
                <p>The return of these methods are objects of the <a href="http://github.com/araujodavid/mydbaas-starting-project/blob/master/mydbaas-api/src/main/java/br/com/arida/ufc/mydbaas/api/pool/common/AbstractPool.java" target="_blank">AbstractPool</a> type. These objects have a list of the resources registered in the <b>knowledge base</b> until now.</p>
                <p>If you know the code of a particular feature it is possible to recover the registry directly. Just use the method below informing the code and type of resource:</p>
                <pre class="prettyprint linenums">
#The code of the resource is integer
#Resource types can be: dbaas, host, machine, dbms or database
... = client.resourceLookupByID([resource id], [resource type]);</pre>
                <p>This method will return the object containing the information of the requested resource. The return type varies with the type of the parameter informed in the method.</p>
              </div>
            </div>
          </div>
          <!--second group ends--> 
          
          <!--third group starts-->
          <div class="accordion-group">
            <div class="accordion-heading"> <a class="accordion-toggle" data-toggle="collapse" href="#collapseThree">- How to add/update resources in the knowledge base?</a> </div>
            <div id="collapseThree" class="accordion-body collapse in">
              <div class="accordion-inner">
                <p>From the objects of "Pool" type is possible to add or update new resources. These objects have the methods <b>save()</b> and <b>update()</b>. Here is an example:</p>
                <pre class="prettyprint linenums">
#Fill out the new resource
DBMS dbms = new DBMS();
#You should check the object
boolean check = dbmsPool.checkEntity(dbms);

#With the object checked just invoke the method to save
boolean result = false;
if (check) {
  result = dbmsPool.save(dbms);
}</pre>
                <pre class="prettyprint linenums">
//...
//Updating a resource object
//...

#Check the object
boolean check = dbmsPool.checkEntity(dbms);

#With the object checked just invoke the method to update
boolean result = false;
if (check) {
  result = dbmsPool.update(dbms);
}</pre>
              </div>
            </div>
          </div>
          <!--third group ends--> 
          
          <!--fourth group starts-->
          <div class="accordion-group">
            <div class="accordion-heading"> <a class="accordion-toggle" data-toggle="collapse" href="#collapseFour">- How to consume the metrics monitored?</a> </div>
            <div id="collapseFour" class="accordion-body collapse in">
              <div class="accordion-inner">
                <p><b>Now the cool part!</b> Through the API you can consume the metrics monitored in the different resources. Here is a list of possible ways to consume:</p>
                <p>To consume the metrics you need to create an object of class <a href="http://github.com/araujodavid/mydbaas-starting-project/blob/master/mydbaas-api/src/main/java/br/com/arida/ufc/mydbaas/api/pool/common/AbstractPool.java" target="_blank">MyMetrics</a>.</p>
                <pre class="prettyprint linenums">
#You must pass client object created earlier as a parameter
MyMetrics myMetrics = new MyMetrics(client);</pre>
                <h5>1. Last collection of a metric:</h5>
                <pre class="prettyprint linenums">
#Retrieving the last collection of the metric Size about a particular DBMS
Size size = (Size) myMetrics.getMetricSingle(Size.class, dbms, MyMetrics.RESOURCE_TYPE_DBMS, null, null);</pre>
                <p>Some metrics can generate more than one collection per cycle. For example, if a virtual machine has more than one core per processor. The agent will collect the metric of Cpu for each core. Also exists a method for recovering the metric in this case:</p>
                <pre class="prettyprint linenums">
#Retrieving the last collection of the metric Cpu about a particular Virtual Machine
List&lt;Object&gt; cpus = myMetrics.getMetricMulti(Cpu.class, vm, MyMetrics.RESOURCE_TYPE_VM, null, null);</pre>
                <p>This variation can also be used in options <b>2</b>, <b>3</b> and <b>4</b>.</p>
                <h5>2. Last collection of a metric starting from a date:</h5>
                <pre class="prettyprint linenums">
Size size = (Size) myMetrics.getMetricSingle(Size.class, dbms, MyMetrics.RESOURCE_TYPE_DBMS, "15-06-2013", null);</pre>
                <pre class="prettyprint linenums">
List&lt;Object&gt; cpus = myMetrics.getMetricMulti(Cpu.class, vm, MyMetrics.RESOURCE_TYPE_VM, "15-06-2013 15:30:00", null);</pre>
                <h5>3. Last collection of a metric until a date:</h5>
                <pre class="prettyprint linenums">
Size size = (Size) myMetrics.getMetricSingle(Size.class, dbms, MyMetrics.RESOURCE_TYPE_DBMS, null, "01-07-2013 10:00");</pre>
                <pre class="prettyprint linenums">
List&lt;Object&gt; cpus = myMetrics.getMetricMulti(Cpu.class, vm, MyMetrics.RESOURCE_TYPE_VM, null, "22-05-2012");</pre>
                <h5>4. Last collection of a metric between two dates:</h5>
                <pre class="prettyprint linenums">
Size size = (Size) myMetrics.getMetricSingle(Size.class, dbms, MyMetrics.RESOURCE_TYPE_DBMS, "10-06-2013", "01-07-2013");</pre>
                <pre class="prettyprint linenums">
List&lt;Object&gt; cpus = myMetrics.getMetricMulti(Cpu.class, vm, MyMetrics.RESOURCE_TYPE_VM, "10-06-2013", "01-07-2013");</pre>
                <h5>5. All collections of a metric:</h5>
                <pre class="prettyprint linenums">
#Retrieving the all collection of the metric Size about a particular Database
List&lt;Object&gt; sizes = myMetrics.getMetricCollection(Size.class, db, MyMetrics.RESOURCE_TYPE_DATABASE, null, null);</pre>
                <h5>6. All collections of a metric starting from a date:</h5>
                <pre class="prettyprint linenums">
List&lt;Object&gt; sizes = myMetrics.getMetricCollection(Size.class, db, MyMetrics.RESOURCE_TYPE_DATABASE, "02-06-2012", null);</pre>
                <h5>7. All collections of a metric until a date:</h5>
                <pre class="prettyprint linenums">
List&lt;Object&gt; sizes = myMetrics.getMetricCollection(Size.class, db, MyMetrics.RESOURCE_TYPE_DATABASE, null, "30-07-2013 12:00:00");</pre>
                <h5>8. All collections of a metric between two dates:</h5>
                <pre class="prettyprint linenums">
List&lt;Object&gt; sizes = myMetrics.getMetricCollection(Size.class, db, MyMetrics.RESOURCE_TYPE_DATABASE, "01-01-2013", "30-06-2013");</pre>
                <p><b>Important!</b> You can use the above methods for any resources and their metrics.</p>
              </div>
            </div>
          </div>
          <!--fourth group ends-->       
         
        </div>
      </div>
      <!--main content ends--> 
      
    </div>
  </div>
</section>
<!-- content ends
================================================== --> 

<!-- footer starts
================================================== -->
<footer id="footer" class="clearfix">
  <div class="container"> 
        
    <!--row starts-->
    <div class="row">       
      <!--column two starts-->
      <div>
          <img src="img/icons/icon-18-address.png" alt="icon"> ARiDa Lab. Federal University of Ceará, Pici, 952 - Fortaleza, 60455-760 </br><img src="img/icons/icon-18-phone.png" alt="icon"> (85) 3366-9847 ext. 216
        </ul>
      </div>
      <!--column two ends-->      
    </div>
    <!--row ends--> 
    
  </div>
</footer>
<!-- footer ends
================================================== --> 

<!-- copyright starts
================================================== -->
<section id="copyright" class="clearfix">
  <div class="container">
    <div class="row">
      <div class="span12">
        <p> © Copyright 2013</p>        
      </div>
    </div>
  </div>
</section>
<!-- copyright ends
================================================== --> 

<!--other jqueries required--> 
<script src="js/bootstrap.js" type="text/javascript" ></script> 
<script src="js/ddsmoothmenu.js" type="text/javascript" ></script> 
<script src="js/twitter.js" type="text/javascript" ></script> 
<script src="js/jquery.easing.1.3.js" type="text/javascript" ></script> 
<script src="js/custom.js" type="text/javascript" ></script>
</body>
</html>